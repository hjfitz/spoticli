# [1] https://docs.microsoft.com/en-us/azure/devops/pipelines/yaml-schema
trigger:
- master

# Each stage has it's own container - 
# if you change something in one stage, it doesn't do anything for the other stage
stages:

# Start with checking the code and running all tests
- stage: Code_Quality
  jobs: 
  - job: TSLint
    displayName: 🧹 Running TSLint
    continueOnError: true # todo: change this one pipeline has been established
    steps: 
      - bash: echo [ETS] Attempting to run linter...
      - bash: yarn
      - bash: yarn lint
  - job: Testing
    displayName: 📚 Testing Code
    continueOnError: true
    steps:
      - bash: echo [ETS] Testing code...
      - bash: yarn
      - bash: yarn test
  - job: Audit
    displayName: 🔐 Auditing Dependencies
    continueOnError: true
    steps:
      - bash: yarn audit
  - job: StaticAnalysis
    displayName: Analysing Source Code
    steps:
      - bash: ./ssca.sh
  - job: Testy
    displayName: do a test
    steps:
      - bash: echo $(which jq)
